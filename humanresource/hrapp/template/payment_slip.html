{% extends 'hr_home.html'%}



{% block body %}
<script type="text/javascript">
  $('document').ready(() =>{
    $("#desi").change( ()=>{
      desig = $('#desi').val();
      userid= $('.userid').val();
      console.log(desig);
      users = []
      $.ajax({
        url:'http://127.0.0.1:8000/hrapp/payment/',
            type:'POST',
            data:{
              desig:desig,
              csrfmiddlewaretoken:'{{ csrf_token }}'
            },
            success: res =>{;
              var ids =""
              $.each(res, function(i, value) {
                ids +=('<option value="'+ value.id+'">'+ value.id +'</option>');
                $('#empid').html(ids);
                users.push(res[i]);
                
              });

              $("#empid").change( () =>{
                  selected_id = $("#empid").val();
                  for(i=0;i<users.length;i++){
                      if(users[i].id == selected_id){
                        $('#emp_name').val(users[i].fname+' '+users[i].lname);
                        break;
                      }
                  }
              });
            },
            error: r =>{
              console.log('error function is loading');
              console.log(r);
            }
      });
    });
  });
</script>

<div class="container">
  <h2>PAYMENT SLIP</h2>   
  <hr>
  <form action="/hrapp/payment/" method="POST">
  <div class="form-group">
    <label>Designation:</label>
    <select class="form-control" name="desig" id="desi">
      <option value="0">Select</option>
      <option  value="HR Manager">HR Manager</option>
      <option value="Project Manager">Project Manager</option>
      <option value="Other">Other</option>
    </select>
    <label>Employee id:</label>
    <select class="form-control" name="empid" id="empid">
      <option selected>select</option>
      <option  value="" selected></option>
    </select>
    <label>Employee name:</label>
    <input type="text" id="emp_name" class="form-control" placeholder="">
    <label>No of unpaid leaves taken:</label>
    <input type="text" name="leaves" class="form-control">
    <label>Deduction per leave:</label>
    <input type="text" name="deduction_amt" class="form-control">
    <label>Total working Hrs:</label>
    <input type="text" name="working_hrs" class="form-control">
    <label>Over Time Hrs:</label>
    <input type="text" name="overtime" class="form-control">
    <label>charges per hr:</label>
    <input type="text" name="charge" class="form-control">

  </div>      
  <hr>   
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Earnings</th>
        <th>Amount</th>
        <th>Deduction</th>
        <th>Amount</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Basic salary</td>
        <td id="salary"></td>
        <td>Taxation</td>
        <td></td>
      </tr>
      <tr>
        <td>Over time Amount(if any)</td>
        <td></td>
        <td>Leave Deduction(if any)</td>
        <td></td>
      </tr>
      <tr>
        <td>Other allowance(if any)</td>
        <td></td>
        <td>Other</td>
        <td></td>
      </tr>
      <tr>
        <td>Total Earnings</td>
        <td></td>
        <td>Total Deduction</td>
        <td></td>
      </tr>
      <tr>
        <td colspan="4"></td>
      </tr>
      <tr>
        <td colspan="3">Total salary:</td>
        <td></td>
      </tr>
    </tbody>
  </table>
  <div class="clearfix">
      <button type="button" class="cancelbtn">Cancel</button>
      <button type="submit" class="signupbtn">Save</button>
    </div>
</div>

{% endblock %}
